---
title: 概率论第二次习题课
category:
  - 概率论
tag:
  - 学习
  - 数学
date: today
# 禁止显示页脚
footer: false
---

## 习题解答

### 第二周作业

::: info （李贤平 1.12）

袋中装有 $1,2,\ldots,N$ 号的球各一只，采用 (1) 有放回；(2) 不放回方式摸球，试求在第 $k$ 次摸球时首次摸到 $1$ 号球的概率.

:::

【解】

(1) 有放回场合下，每一次抽球抽到 $1$ 号球的概率均为 $\dfrac{1}{N}$，因此首次摸到 $1$ 号球的概率为
$$
P_k=\frac{1}{N}\cdot\left(\frac{N-1}{N}\right)^{k-1}=\frac{(N-1)^{k-1}}{N^k}
$$
事实上这就是参数 $p=\dfrac{1}{N}$ 的**几何分布**的分布列.

(2) 无放回场合下，有两种思路来计算这个概率.

1. 此时题目等价于**开锁模型**，即求从若干把不同的钥匙中依次尝试，第 $k$ 次打开锁的概率. 这个概率可以如下求得：
    $$
    P_k=\frac{N-1}{N}\cdot\frac{N-2}{N-1}\cdot\ldots\cdot\frac{k}{k+1}\cdot\frac{1}{k}=\frac{1}{N}
    $$
    上面这个等式的实质是乘法公式. 这表明无放回场合下在第 $k$ 次摸球时首次摸到 $1$ 号球的概率总是 $\frac{1}{N}$，与 $k$ 无关.
2. 在第 $k$ 次摸球首次摸到 $1$ 号球，表明在前 $k$ 次摸球中一定恰摸到了一次 $1$ 号球，这是一个超几何概率；且这是最后一次摸球，这相当于在所有 $1$ 号球可能出现的 $k$ 个位置中只有一个是符合题意的. 因此可以用乘法原理计算概率.
    $$
    P_k=\frac{\displaystyle\binom{N-1}{k-1}\binom{1}{1}}{\displaystyle\binom{N}{k}}\frac{1}{k}=\frac{1}{N}
    $$

::: info （李贤平 1.13）

从 $6$ 双不同的手套中任选 $4$ 只，问其中恰有一双配对的概率是多少.

:::

【解】

本题是典型的古典概型内容. $6$ 双手套共 $12$ 只，故总样本点数量为 $\displaystyle\binom{12}{4}$；需要恰好取得一双，可以认为先从 $6$ 双手套中取出 $1$ 双，再从其余的 $5$ 双袜子中取两只，且它们不能来自同一双袜子. 因此可以先取两双袜子，再从每双中的两只各取一只，因此符合条件的样本点数共有 $\displaystyle\binom{6}{1}\binom{5}{2}\binom{2}{1}\binom{2}{1}$. 综上，所求概率为
$$
\frac{\displaystyle\binom{6}{1}\binom{5}{2}\binom{2}{1}\binom{2}{1}}{\displaystyle\binom{12}{4}}=\frac{16}{33}
$$

::: info （李贤平 1.14）

从 $n$ 双不同的鞋子中任取 $2r(2r<n)$ 只，求下列事件发生的概率：(1) 没有成对的鞋子；(2) 只有一对鞋子；(3) 恰有两对鞋子；(4) 有 $r$ 对鞋子.

:::

【解】

本题是 1.13 的推广，核心思想仍为：先取出成对的鞋子，再取出单个的鞋子. 总样本点数量为 $\displaystyle\binom{2n}{2r}$

(1) 没有成对的鞋子，即每只鞋子都来自不同的一对，因此需要先在 $n$ 对鞋子中取 $2r$ 对鞋子，再在每对鞋子中的两只中任取一只. 因此满足条件的样本点数量为 $\displaystyle\binom{n}{2r}2^{2r}$，从而所求概率为
$$
P_0=\frac{\displaystyle\binom{n}{2r}2^{2r}}{\displaystyle\binom{2n}{2r}}
$$

(2) 只有一对鞋子，因此先取出它，取法有 $\displaystyle\binom{n}{1}$ 种. 再从其余的 $n-1$ 对鞋子种取出 $2r-2$ 只鞋子，且它们不成对，这就转化为了 (1) 的问题，此时共有 $\displaystyle\binom{n-1}{2r-2}2^{2r-2}$ 种取法. 从而所求概率为
$$
P_1=\frac{\displaystyle\binom{n}{1}\binom{n-1}{2r-2}2^{2r-2}}{\displaystyle\binom{2n}{2r}}
$$

(3) 恰有两对鞋子，因此先取出它们，取法有 $\displaystyle\binom{n}{2}$ 种. 再从其余的 $n-2$ 对鞋子种取出 $2r-4$ 只鞋子，且它们不成对，这也转化为了 (1) 的问题，此时共有 $\displaystyle\binom{n-2}{2r-4}2^{2r-4}$ 种取法. 从而所求概率为
$$
P_2=\frac{\displaystyle\binom{n}{2}\binom{n-2}{2r-4}2^{2r-4}}{\displaystyle\binom{2n}{2r}}
$$

(4) 有 $r$ 对鞋子，因此只需要取出它们，取法有 $\displaystyle\binom{n}{r}$ 种. 从而所求概率为
$$
P_r=\frac{\displaystyle\binom{n}{r}}{\displaystyle\binom{2n}{2r}}
$$

::: info （李贤平 1.15）

$m$ 个男孩和 $n$ 个女孩 $n\le m$ 随机沿圆桌坐下，试求任意两个女孩都不相邻的概率.

:::

【解】

本题涉及到圆排列. 如果是 $n$ 个人排成一条直线，排列总数为 $n!$；但由于圆具有旋转对称性，将一个圆上的排列进行旋转，得到的排列和之前的排列等价. 因此 $n$ 个人的圆排列总数为 $\dfrac{n!}{n}=(n-1)!$.

具体在本题中，共有 $m+n$ 人参与排列，因此样本点总数为 $(m+n-1)!$. 此时先考虑男生落座，共有 $(m-1)!$ 种排列，再考虑将 $n$ 个女生安排在男生落座后产生的 $m$ 个空位中，因此选出这 $n$ 个座位共有 $\displaystyle\binom{m}{n}$ 种取法. 需要注意，由于男生落座后，产生的 $m$ 个空位不再像普通的圆排列一样具有旋转对称性了，所以在这 $n$ 个座位中安排女生落座共有 $n!$ 中方法. 因此符合要求的样本点总数为 $(m-1)!n!\displaystyle\binom{m}{n}$. 从而所求概率为
$$
P=\frac{(m-1)!n!\displaystyle\binom{m}{n}}{(m+n-1)!}=\frac{\displaystyle\binom{m}{n}}{\displaystyle\binom{m+n-1}{n}}
$$

::: info （李贤平 1.16）

甲、乙二人各出赌注 $a$，约定谁先胜三局则赢得全部赌注，现已赌三局，甲二胜一负，这时因故终止赌博，若二人赌技相同，问应如何分配赌注，才算公平合理.

:::

【解】

二人赌技相同说明两人在一次赌局中的胜利概率均为 $\dfrac{1}{2}$. 此时应当按照如果赌局继续进行，两人最终获胜的概率来分配赌注. 甲最终获胜只需赢下第四局，或输掉第四局后赢下第五局即可. 因此甲获胜的概率为 
$$
P_{\text{甲}}=\dfrac{1}{2}+\dfrac{1}{2}\cdot\dfrac{1}{2}=\dfrac{3}{4}
$$
从而甲应当分得 $\dfrac{3}{4}a$，而乙应分得 $\dfrac{1}{4}a$.

::: info （李贤平 1.17）

从 $52$ 张扑克牌中任意取出 $13$ 张，求：

(1) 有 $5$ 张黑桃，$3$ 张红心，$3$ 张方块，$2$ 张草花的概率；

(2) 牌型分布为 $7$-$3$-$2$-$1$（最长花色有 $7$ 张，最短花色有 $1$ 张，其余二花色分别有 $3$ 张及 $2$ 张）的概率.

:::

【解】

本题是经典的古典概型问题. 样本点总数为 $\displaystyle\binom{52}{13}$.

(1) 这实际上就是从每类牌中取出对应数量的牌，由于分步取得所以可以使用乘法原理得到符合条件的样本点总数为
$$
\binom{13}{5}\binom{13}{3}\binom{13}{3}\binom{13}{2}
$$
因此所求概率为
$$
P_1=\frac{\displaystyle\binom{13}{5}\binom{13}{3}\binom{13}{3}\binom{13}{2}}{\displaystyle\binom{52}{13}}
$$
这个概率计算的实质是一个**多变量超几何分布**.

(2) 本题条件下每种牌中取出的数量都不一样，这实际上简化了我们的思维量：只需要考虑一个特定情况（如取出 $7$ 张黑桃，$3$ 张红心，$2$ 张方块，$1$ 张草花）的概率，再乘以所有的花色的排列数即可. 因此符合条件的样本点总数为
$$
4!\cdot \binom{13}{7}\binom{13}{3}\binom{13}{2}\binom{13}{1}
$$
因此所求概率为
$$
P_2=\frac{4!\cdot \displaystyle\binom{13}{7}\binom{13}{3}\binom{13}{2}\binom{13}{1}}{\displaystyle\binom{52}{13}}
$$

【思考】(3) 求牌型分布为 $5$-$3$-$3$-$2$ 的概率.

::: info （李贤平 1.20）

从装有号码 $1,2,\ldots,N$ 的球的箱子中有放回地摸了 $n$ 次球，依次记下其号码，试求这些号码按严格上升次序排列的概率.

:::

【解】

本题为有放回摸球，因此样本点总数为 $N^n$. 由于需要取出 $n$ 次球的号码**严格**上升，我们首先需要取出 $n$ 个完全不同的球. 考虑它们的顺序，取出 $n$ 个不同球的总取法为 $\dfrac{N!}{(N-n)!}$. 其中，只有唯一一种取法可以让取出的号码严格上升，因此符合题意的总取法为
$$
\dfrac{N!}{(N-n)!}\cdot \frac{1}{n!}=\binom{N}{n}
$$
因此所求概率为
$$
P=\frac{\displaystyle\binom{N}{n}}{N^n}
$$

::: info （李贤平 1.22）

任意从数列 $1,2,\ldots,N$ 中不放回地取出 $n$ 个数并按大小排列成 $x_1<x_2<\ldots<x_m<\ldots<x_n$，试求 $x_m=M$ 的概率，这里 $1\le M\le N$.

:::

【解】

可以证明，不放回地取出 $n$ 个数并按大小排列它们得到的排列实质上和不放回取出 $n$ 个数的组合之间存在一一对应. 因此可以从组合的视角来解决这个排列问题. 在组合视角下，样本点总数为 $\displaystyle\binom{N}{n}$. 为了使 $x_m=M$，我们必须从前 $M-1$ 个数中取出 $m-1$ 个，而从后 $N-M$ 个数中取出 $n-m$ 个，因此符合题意的样本点总数为
$$
\binom{M-1}{m-1}\binom{1}{1}\binom{N-M}{n-m}
$$
从而所求概率为
$$
P=\frac{\displaystyle\binom{M-1}{m-1}\binom{1}{1}\binom{N-M}{n-m}}{\displaystyle\binom{N}{n}}
$$

::: info （李贤平 1.24）

从 $(0,1)$ 中随机地取两个数，求下列概率：

(1) 两数之和小于 $1.2$；

(2) 两数之积小于 $\dfrac{1}{4}$；

(3) 以上两个要求同时满足.

:::

【解】

这是一个经典的几何概型问题. 由于是从 $(0,1)$ 中随机地取两个数，记两个数分别为 $x,y$，则样本空间为平面直角坐标系上的一个单位正方形.

(1) 需要 $x+y< 1.2$，即求单位正方形在直线 $x+y=1.2$ 下方的面积. 

![两数之和小于 $1.2$](/assets/images/exercise%20lesson/geo-prob1.svg#center)

因此所求面积为
$$
S_1=1-\frac{1}{2}\times 1.2^2=0.68
$$
从而所求概率为
$$
P_1=\frac{S_1}{S_\Omega}=\frac{0.68}{1}=0.68
$$

(2) 需要 $xy<\dfrac{1}{4}$，即求单位正方形在双曲线 $xy=\dfrac{1}{4}(x>0)$ 下方的面积. 联立 $xy=\dfrac{1}{4}$ 和 $y=1$ 得到 $(x,y)=\left(\dfrac{1}{4},1\right)$. 

![两数之积小于 $\dfrac{1}{4}$](/assets/images/exercise%20lesson/geo-prob2.svg#center)

因此所求面积为
$$
S_2=1\times\frac{1}{4}+\int_{1/4}^1 \frac{1}{4x}\mathrm{d}x=\frac{1}{4}+\frac{1}{2}\ln 2
$$
从而所求概率为
$$
P_2=\frac{S_2}{S_\Omega}=\frac{S_2}{1}=\frac{1}{4}+\frac{1}{2}\ln 2
$$

(3) 在以上两个条件同时满足时，我们必须确定图形的画法. 联立 $xy=\dfrac{1}{4}$ 和 $x+y=1.2$，解得 $x=\dfrac{6\pm\sqrt{11}}{10}$. 因此，目标图形可以看作 (1) 中求解的多边形中挖去 $xy=\dfrac{1}{4}$ 和 $x+y=1.2$ 围成的图形.

![两个条件同时满足](/assets/images/exercise%20lesson/geo-prob3.svg#center)

先求 $xy=\dfrac{1}{4}$ 和 $x+y=1.2$ 围成图形的面积. 记 $x_1=\dfrac{6-\sqrt{11}}{10}, x_2=\dfrac{6+\sqrt{11}}{10}$, 则该面积为
$$
\begin{align*}
  S & = \int_{x_1}^{x_2} \left((1.2-x)-\frac{1}{4x}\right)\mathrm{d}x \\
  & = 1.2(x_2-x_1)-\frac{1}{2}(x_2^2-x_1^2)-\frac{1}{4}(\ln x_2-\ln x_1) \\
  & = \frac{3\sqrt{11}}{25} - \frac{1}{2}\ln\left(\frac{6+\sqrt{11}}{5}\right)
\end{align*}
$$
因此所求图形的面积为
$$
\begin{align*}
  S_3 & = S_1-S \\
  & =0.68-\frac{3\sqrt{11}}{25} - \frac{1}{2}\ln\left(\frac{6+\sqrt{11}}{5}\right) \\
  &=\dfrac{17 - 3\sqrt{11}}{25} + \dfrac{1}{2}\ln\left(\dfrac{6+\sqrt{11}}{5}\right)
\end{align*}
$$
从而所求概率为
$$
P_3=\frac{S_3}{S_\Omega}=\frac{S_3}{1}=\dfrac{17 - 3\sqrt{11}}{25} + \dfrac{1}{2}\ln\left(\dfrac{6+\sqrt{11}}{5}\right)\approx 0.5932
$$

::: info （李贤平 1.26）

在一张打上方格的纸上投一枚直径为 $1$ 的硬币，方格要多小才能使硬币与线不相交的概率小于 $1\%$.

:::

【解】

设方格的边长为 $a$，我们可以将硬币简化为它的中心，考虑该中心点距离所有网格线的的距离都大于 $\dfrac{1}{2}$ 的概率. 由于对称性，我们可以只考虑在一个正方形内的情形. 设该方格的左下角顶点为 $(0,0)$，硬币中心的坐标为 $(x,y)$，由此确定了一个样本空间 $\Omega=[0,a]\times[0,a]$. 由于该中心点离正方形的四边距离均大于 $1$，可以得到下面的不等式
$$
\dfrac{1}{2}<x<a-\dfrac{1}{2}
$$
$$
\dfrac{1}{2}<y<a-\dfrac{1}{2}
$$
它确定了我们的目标区域，其面积为 $S=(a-1)^2$，因此硬币中心落到该区域的概率为
$$
P=\frac{S}{S_\Omega}=\frac{(a-1)^2}{a^2}=(1-\frac{1}{a})^2<1\%
$$
解得 $a<\dfrac{10}{9}$.

::: info （李贤平 1.42）

父，母，子三人举行比赛，每局总有一人胜一人负（没有和局），每局的优胜者就与未参加此局的人再进行比赛，如果某人首先胜了两局，则他就是整个比赛的优胜者，由父决定第一局由哪两个人参加，其中儿子实力最强，所以父为了使自己得胜的概率达到最大，就决定第一局由他与妻子先比赛，试证父的决策为最优策略（任何一对选手中一人胜对方的概率在整个比赛中是不变的.

:::

【解】

注意到比赛至多进行4局，下面分析三种不同开局下父亲获胜的概率 $P_{k}$. 为方便分别用 $1,2,3$ 表示父、母和子，且用 $p_{ij}$ 记 $i$ 战胜 $j(i,j\in\{1,2,3\})$.

1. 题设的情况，即父先与母比赛. 此时 $P_1=p_{12}p_{13}+p_{12}p_{31}p_{23}p_{12}+p_{21}p_{32}p_{13}p_{12}=p_{12}p_{13}+p_{12}^2 p_{31}p_{23}+p_{21}p_{32}p_{13}p_{12}$;
2. 若父先与子比赛，此时 $P_2=p_{13}p_{12}+p_{13}^2 p_{21}p_{32}+p_{31}p_{23}p_{12}p_{13}$.
3. 若母先与子比赛，则父亲必须连续赢下母和子，与第一局谁赢下无关，所以 $P_3=p_{12}p_{13}$.

此时显然有 $P_1>P_3$，所以只需要证明 $P_1>P_2$. 下面计算 $P_1-P_2$.
$$
\begin{align*}
  P_1-P_2&=p_{21}p_{32}p_{13}(p_{12}-p_{13})+p_{31}p_{23}p_{12}(p_{12}-p_{13})\\
  &=(p_{12}-p_{13})(p_{21}p_{32}p_{13}+p_{31}p_{23}p_{12})
\end{align*}
$$
注意到后一项一定为正，所以整个式子的正负仅取决于第一项的正负. 已知儿子实力最强，因此父亲战胜儿子的概率将小于父亲战胜母亲的概率，因此有 $P_1>P_2$. 这就证明了父亲的策略是最优的.

::: info （李贤平 1.45）

证明：$|P(AB)-P(A)P(B)|\le\dfrac{1}{4}$，并讨论等号成立的条件.

:::

【解】

这里提供两种做法.

（法一）一方面，使用全概率公式
$$
\begin{align*}
  P(A)P(B)-P(AB) & = P(A) [P(AB)+P(\bar{A} B)]-P(AB) \\
  &=P(A)P(\bar{A}B)-P(AB) [1-P(A)] \\
  &\le P(A)P(\bar{A}B) \\
  &\le P(A) [1-P(A)]\le \dfrac{1}{4}
\end{align*}
$$
另一方面，不妨设 $P(A)\ge P(B)$，则
$$
P(AB)-P(A)P(B)\le P(B)-P(B)^2\le \dfrac{1}{4}
$$
这就证明了结论.

可以看出，上面不等式的等号当且仅当 $P(A)=P(B)=\dfrac{1}{2}$ 时成立.

（法二）考虑事件 $A,B$ 的示性 $I_A,I_B$, 事件的概率即期望的示性，从而
$$
|P(AB)-P(A)P(B)|=|E(I_AI_B)-E(I_A)E(I_B)|=|\mathrm{Cov}(I_A,I_B)|
$$
考虑 Cauchy-Schwarz 不等式，得到 $|\mathrm{Cov}(I_A,I_B)|\le \sqrt{\mathrm{Var}(I_A)\mathrm{Var}(I_B)}$.

又 $\mathrm{Var}(I_A)=E(I_A^2)-E(I_A)^2=E(I_A)-E(I_A)^2=P(A)(1-P(A))\le\dfrac{1}{4}$，同理 $\mathrm{Var}(I_B)\le\dfrac{1}{4}$.

这就得到了 $|P(AB)-P(A)P(B)|\le \sqrt{\dfrac{1}{4}\cdot \dfrac{1}{4}}=\dfrac{1}{4}$.
